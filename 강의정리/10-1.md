# 10-1

## API란?

`앱/웹 서비스`를 만드는 개발자들이 용하는 데이터 위주의 서비스
시간이 지나도 호환성을 유지해야한다.

- 앱 등의 유저가 사용하는 UI는 유저가 원할 때 업데이트가 된다.
- 유저층이 사용하는 앱의 버전이 다양하기에 API도 버전 개념을 둔다.
- 그에 반해 웹 서비스를 이용하는 유저는 항상 최신 버전을 사용한다.

## REST

`아키텍처` 스타일, `프로토콜`에 독립적 -> 일반적인 REST구현에서 HTTP를 사용

- 리소스 중심 디자인
- 클라이언트에서 엑세스 할 수 있는 모든 종류의 개체/서비스가 리소스에 포함
- 리소스 마다 해당 리소스를 고유하게 식별하는 식별자
- 요청/응답 포맷으로 흔히 JSON을 사용한다
- 균일한 인터페이스를 적용 
- 리소스에 표준 HTTP 동사 (`GET`, `POST`, `PUT`, `PATCH`, `DELETE`)를 적용

## 리소스를 중심으로 API를 구성

`/customers` -> 고객 컬랙션  
`/customers/5` -> PK가 5인 고객  
`/customers/5/orders` -> PK가 5인 고객에 대한 모든 주문  

## 심플하게 URI를 구성하기

`/customers/1/orders`를 통해 고객 1의 모든 주문을 찾은 후에  
`orders/99/products/`로 변경해서 동일한 처리를 한다.  
-> 유연하게 변경  

## HTTP 메소드를 기준으로 기본 작업을 정의

- `GET` : 리소스의 표현
- `POST` : 새 리소스 생성 요청
- `PUT` : 기존 리소스를 대체 **멱등성**이 보장돼야한다.
- `PATCH` : 기존 리소스를 부분 대체 **멱등성미보장**
- `DELETE` : 지정 리소스 제거

## HTTP Method별 상태코드

- `GET` : 일반적 200(OK) 못찾으면 404(Not Found)
- `POST` : 201(Created), 새 리소스의 URI는 응답의 Location 헤더에 새 리소스가 없다면 200을 응답하고 반환할 결과가 없다면 204를 반환할수도 있다. `잘못된` 요청이면 400(잘못된 요청)을 반환한다.
- `PUT` : 기존 리소스 업데이트 200 또는 204를 반환 상황에 따라 업데이트 할수 없다면 409(충돌)을 반환한다.
- `DELETE` : 성공하면 204를 응답하고 리소스가 없다면 404를 반환한다.
- `비동기작업`
  - 작업 완료에 시간이 오래 걸린다면 다른 Task Queue를 통해 비동기 처리를 할 수 있다. (`Celery`)등.. 이때 요청이 수락되었지만 아직 완료되기 전을 나타내는 202를 응답한다.
  - 클라이언트가 이 작업을 Polling을 통해 모니터링할 수 있도록 비동기 요청의 상태를 반환하는 URI를 헤더로 반환.


## Django-rest-framework

- 설계의 영역에서는 다루지않는다
- 장고 API에서 널리 쓰여지는 DRF에 대해서 자세히 보는 시간
  - 장고의 패러다임하에 빠르고 관리하기 쉬운 API
  - DRF는 REST API 컨셉을 쉽게 만들도록 지원한다.

 
## DRF의 주요 기능들

- 시리얼라이저/모델시리얼라이저를 통한 데이터 유효성 검증 및 직렬화
- 각종 Parser를 통한 데이터 처리
- APIView/Generic/ViewSet/ModelViewSets 를 통한 요청 처리
- 각종 Renderer를 통한 다양한 응답 포맷 지원
- 인증(Authentication)/권한(Permission)체계 - 써드파티를 통해 JWT를 지원
- Throttling(최대 호출 횟수 제한)

